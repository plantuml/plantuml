<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>GanttDiagram.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">plantuml</a> &gt; <a href="index.source.html" class="el_package">net.sourceforge.plantuml.project</a> &gt; <span class="el_source">GanttDiagram.java</span></div><h1>GanttDiagram.java</h1><pre class="source lang-java linenums">/* ========================================================================
 * PlantUML : a free UML diagram generator
 * ========================================================================
 *
 * (C) Copyright 2009-2024, Arnaud Roques
 *
 * Project Info:  https://plantuml.com
 *
 * If you like this project or if you find it useful, you can support us at:
 *
 * https://plantuml.com/patreon (only 1$ per month!)
 * https://plantuml.com/paypal
 *
 * This file is part of PlantUML.
 *
 * PlantUML is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * PlantUML distributed in the hope that it will be useful, but
 * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
 * or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public
 * License for more details.
 *
 * You should have received a copy of the GNU General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301,
 * USA.
 *
 *
 * Original Author:  Arnaud Roques
 *
 *
 */
package net.sourceforge.plantuml.project;

import java.io.IOException;
import java.io.OutputStream;
import java.time.DayOfWeek;
import java.time.LocalDate;
import java.util.ArrayList;
import java.util.Collections;
import java.util.List;
import java.util.Locale;
import java.util.Map;
import java.util.Objects;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

import net.sourceforge.plantuml.FileFormatOption;
import net.sourceforge.plantuml.TitledDiagram;
import net.sourceforge.plantuml.WithSprite;
import net.sourceforge.plantuml.command.CommandExecutionResult;
import net.sourceforge.plantuml.core.DiagramDescription;
import net.sourceforge.plantuml.core.ImageData;
import net.sourceforge.plantuml.core.UmlSource;
import net.sourceforge.plantuml.klimt.color.HColor;
import net.sourceforge.plantuml.klimt.color.HColorSet;
import net.sourceforge.plantuml.klimt.color.HColors;
import net.sourceforge.plantuml.klimt.creole.Display;
import net.sourceforge.plantuml.klimt.font.StringBounder;
import net.sourceforge.plantuml.klimt.shape.TextBlock;
import net.sourceforge.plantuml.preproc.PreprocessingArtifact;
import net.sourceforge.plantuml.project.core.Moment;
import net.sourceforge.plantuml.project.core.MomentImpl;
import net.sourceforge.plantuml.project.core.PrintScale;
import net.sourceforge.plantuml.project.core.Resource;
import net.sourceforge.plantuml.project.core.Task;
import net.sourceforge.plantuml.project.core.TaskAttribute;
import net.sourceforge.plantuml.project.core.TaskCode;
import net.sourceforge.plantuml.project.core.TaskGroup;
import net.sourceforge.plantuml.project.core.TaskImpl;
import net.sourceforge.plantuml.project.core.TaskInstant;
import net.sourceforge.plantuml.project.core.TaskSeparator;
import net.sourceforge.plantuml.project.data.DayCalendarData;
import net.sourceforge.plantuml.project.data.DisplayConfigData;
import net.sourceforge.plantuml.project.data.GanttModelData;
import net.sourceforge.plantuml.project.data.TaskDrawRegistryData;
import net.sourceforge.plantuml.project.data.TimeBoundsData;
import net.sourceforge.plantuml.project.data.TimeScaleConfigData;
import net.sourceforge.plantuml.project.data.TimelineStyleData;
import net.sourceforge.plantuml.project.data.WeekConfigData;
import net.sourceforge.plantuml.project.draw.TaskDrawRegular;
import net.sourceforge.plantuml.project.draw.WeeklyHeaderStrategy;
import net.sourceforge.plantuml.project.draw.header.TimeHeader;
import net.sourceforge.plantuml.project.draw.header.TimeHeaderFactory;
import net.sourceforge.plantuml.project.lang.CenterBorderColor;
import net.sourceforge.plantuml.project.ngm.math.PiecewiseConstant;
import net.sourceforge.plantuml.project.solver.ImpossibleSolvingException;
import net.sourceforge.plantuml.project.time.TimePoint;
import net.sourceforge.plantuml.project.time.WeekNumberStrategy;
import net.sourceforge.plantuml.skin.UmlDiagramType;
import net.sourceforge.plantuml.stereo.Stereotype;
import net.sourceforge.plantuml.style.ClockwiseTopRightBottomLeft;
import net.sourceforge.plantuml.style.SName;
import net.sourceforge.plantuml.style.Style;
import net.sourceforge.plantuml.style.StyleSignatureBasic;

public class GanttDiagram extends TitledDiagram implements WithSprite, GanttStyle {

	// ------------------------------------------------------------------------
	// model / prepared state
	// ------------------------------------------------------------------------
<span class="fc" id="L105">	private final GanttModelData modelData = new GanttModelData();</span>
<span class="fc" id="L106">	private final TimeBoundsData timeBounds = new TimeBoundsData();</span>
<span class="fc" id="L107">	private final TimeScaleConfigData scaleConfig = new TimeScaleConfigData();</span>
<span class="fc" id="L108">	private final WeekConfigData weekConfig = new WeekConfigData();</span>
<span class="fc" id="L109">	private final DayCalendarData dayCalendar = new DayCalendarData();</span>
<span class="fc" id="L110">	private final DisplayConfigData displayConfig = new DisplayConfigData();</span>
<span class="fc" id="L111">	private final TaskDrawRegistryData drawRegistry = new TaskDrawRegistryData();</span>
	private final TimelineStyleData timelineStyle;

	// ------------------------------------------------------------------------
	// diagram configuration (styling / options)
	// ------------------------------------------------------------------------

	private TimePoint today;

<span class="fc" id="L120">	private int defaultCompletion = 100;</span>

	// ------------------------------------------------------------------------
	// parsing / &quot;current&quot; pointers (stateful command interpretation)
	// ------------------------------------------------------------------------
	private Task it;
	private Resource they;
<span class="fc" id="L127">	private TaskGroup currentGroup = null;</span>

	// ------------------------------------------------------------------------
	// constants / patterns
	// ------------------------------------------------------------------------
<span class="fc" id="L132">	private static final Pattern RESOURCE_ASSIGNMENT_PATTERN = Pattern.compile(&quot;([^:]+)(:(\\d+))?&quot;);</span>

	public CommandExecutionResult changeLanguage(String lang) {
<span class="nc" id="L135">		this.weekConfig.setLocale(new Locale(lang));</span>
<span class="nc" id="L136">		return CommandExecutionResult.ok();</span>
	}

	public DiagramDescription getDescription() {
<span class="fc" id="L140">		return new DiagramDescription(&quot;(Gantt)&quot;);</span>
	}

	public void setWeekNumberStrategy(DayOfWeek firstDayOfWeek, int minimalDaysInFirstWeek) {
<span class="nc" id="L144">		this.weekConfig.setWeekNumberStrategy(new WeekNumberStrategy(firstDayOfWeek, minimalDaysInFirstWeek));</span>
<span class="nc" id="L145">	}</span>

	public GanttDiagram(UmlSource source, PreprocessingArtifact preprocessing) {
<span class="fc" id="L148">		super(source, UmlDiagramType.GANTT, null, preprocessing);</span>
<span class="fc" id="L149">		this.timelineStyle = new TimelineStyleData(getSkinParam(), this, HColorSet.instance());</span>
<span class="fc" id="L150">	}</span>

	public final int getDpi(FileFormatOption fileFormatOption) {
<span class="nc" id="L153">		return 96;</span>
	}

	@Override
	protected ImageData exportDiagramNow(OutputStream os, int index, FileFormatOption fileFormatOption)
			throws IOException {
<span class="fc" id="L159">		return createImageBuilder(fileFormatOption).drawable(getTextMainBlock(fileFormatOption)).write(os);</span>
	}

	public void setPrintScale(PrintScale printScale) {
<span class="fc" id="L163">		this.scaleConfig.setPrintScale(printScale);</span>
<span class="fc" id="L164">	}</span>

	public void setFactorScale(double factorScale) {
<span class="nc" id="L167">		this.scaleConfig.setFactorScale(factorScale);</span>
<span class="nc" id="L168">	}</span>

	@Override
	public String checkFinalError() {
		try {
<span class="fc" id="L173">			initMinMax();</span>
<span class="nc" id="L174">		} catch (ImpossibleSolvingException ex) {</span>
<span class="nc" id="L175">			return ex.getMessage();</span>
<span class="fc" id="L176">		}</span>
<span class="fc" id="L177">		return null;</span>
	}

	@Override
	protected TextBlock getTextMainBlock(FileFormatOption fileFormatOption) {
<span class="fc" id="L182">		final StringBounder stringBounder = fileFormatOption.getDefaultStringBounder(getSkinParam());</span>
<span class="pc bpc" id="L183" title="1 of 2 branches missed.">		if (this.timeBounds.getPrintStart() == null) {</span>
<span class="fc" id="L184">			initMinMax();</span>
		} else {
<span class="nc" id="L186">			this.timeBounds.setMinDay(this.timeBounds.getPrintStart());</span>
<span class="nc" id="L187">			this.timeBounds.setMaxDay(this.timeBounds.getPrintEnd());</span>
		}
<span class="fc" id="L189">		final TimeHeaderFactory factory = new TimeHeaderFactory(this.weekConfig, this.dayCalendar, this.timeBounds,</span>
				this.scaleConfig, this.timelineStyle);

<span class="fc" id="L192">		final TimeHeader timeHeader = factory.createTimeHeader();</span>

<span class="fc" id="L194">		return new GanttDiagramMainBlock(this.timeBounds, this.modelData, this.drawRegistry, this.displayConfig,</span>
				this.timelineStyle, this, timeHeader, stringBounder);
	}

	private void initMinMax() {
<span class="fc" id="L199">		timeBounds.initMinMax(modelData, dayCalendar);</span>
<span class="fc" id="L200">	}</span>

	@Override
	public final Style getStyle(SName param) {
<span class="fc" id="L204">		return StyleSignatureBasic.of(SName.root, SName.element, SName.ganttDiagram, param)</span>
<span class="fc" id="L205">				.getMergedStyle(getCurrentStyleBuilder());</span>
	}

	@Override
	public final Style getStyle(SName param1, SName param2) {
<span class="fc" id="L210">		return StyleSignatureBasic.of(SName.root, SName.element, SName.ganttDiagram, param1, param2)</span>
<span class="fc" id="L211">				.getMergedStyle(getCurrentStyleBuilder());</span>
	}

	public StyleSignatureBasic getDefaultStyleDefinitionArrow() {
<span class="nc" id="L215">		return StyleSignatureBasic.of(SName.root, SName.element, SName.ganttDiagram, SName.arrow);</span>
	}

	public void closeDayOfWeek(DayOfWeek day, String task) {
<span class="fc" id="L219">		this.dayCalendar.getOpenClose().close(day);</span>
<span class="fc" id="L220">	}</span>

	public void openDayOfWeek(DayOfWeek day, String task) {
<span class="nc bnc" id="L223" title="All 2 branches missed.">		if (task.length() == 0)</span>
<span class="nc" id="L224">			this.dayCalendar.getOpenClose().open(day);</span>
		else
<span class="nc" id="L226">			this.dayCalendar.getOpenCloseForTask(task).open(day);</span>
<span class="nc" id="L227">	}</span>

	public void closeDayAsDate(LocalDate day, String task) {
<span class="nc bnc" id="L230" title="All 2 branches missed.">		if (task.length() == 0)</span>
<span class="nc" id="L231">			this.dayCalendar.getOpenClose().close(day);</span>
		else
<span class="nc" id="L233">			this.dayCalendar.getOpenCloseForTask(task).close(day);</span>

<span class="nc" id="L235">	}</span>

	public void openDayAsDate(LocalDate day, String task) {
<span class="nc bnc" id="L238" title="All 2 branches missed.">		if (task.length() == 0)</span>
<span class="nc" id="L239">			this.dayCalendar.getOpenClose().open(day);</span>
		else
<span class="nc" id="L241">			this.dayCalendar.getOpenCloseForTask(task).open(day);</span>

<span class="nc" id="L243">	}</span>

	public TimePoint getThenDate() {
<span class="nc" id="L246">		TimePoint result = TimePoint.ofStartOfDay(this.timeBounds.getMinDay());</span>
<span class="nc bnc" id="L247" title="All 2 branches missed.">		for (TimePoint d : this.dayCalendar.getColorDays())</span>
<span class="nc bnc" id="L248" title="All 2 branches missed.">			if (d.compareTo(result) &gt; 0)</span>
<span class="nc" id="L249">				result = d;</span>

<span class="nc bnc" id="L251" title="All 2 branches missed.">		for (TimePoint d : this.dayCalendar.getNameDays().keySet())</span>
<span class="nc bnc" id="L252" title="All 2 branches missed.">			if (d.compareTo(result) &gt; 0)</span>
<span class="nc" id="L253">				result = d;</span>

<span class="nc" id="L255">		return result;</span>
	}

	public Task getExistingTask(String id) {
<span class="nc" id="L259">		final TaskCode code = TaskCode.fromId(Objects.requireNonNull(id));</span>
<span class="nc" id="L260">		return this.modelData.getTask(code);</span>
	}

	public GanttConstraint forceTaskOrder(Task task1, Task task2) {
<span class="fc" id="L264">		final TaskInstant end1 = new TaskInstant(task1, TaskAttribute.END);</span>
<span class="fc" id="L265">		task2.setStart(end1.getInstantPrecise());</span>
<span class="fc" id="L266">		final GanttConstraint result = new GanttConstraint(this.getIHtmlColorSet(),</span>
<span class="fc" id="L267">				getSkinParam().getCurrentStyleBuilder(), end1, new TaskInstant(task2, TaskAttribute.START));</span>
<span class="fc" id="L268">		addContraint(result);</span>
<span class="fc" id="L269">		return result;</span>
	}

	public Task getOrCreateTask(TaskCode code, boolean linkedToPrevious) {
<span class="fc" id="L273">		Task result = this.modelData.getTask(Objects.requireNonNull(code));</span>
<span class="fc bfc" id="L274" title="All 2 branches covered.">		if (result == null) {</span>
<span class="fc" id="L275">			Task previous = null;</span>
<span class="pc bpc" id="L276" title="1 of 2 branches missed.">			if (linkedToPrevious)</span>
<span class="nc" id="L277">				previous = getLastCreatedTask();</span>

<span class="fc" id="L279">			result = new TaskImpl(this, getSkinParam().getCurrentStyleBuilder(), code,</span>
<span class="fc" id="L280">					TimePoint.ofStartOfDay(this.timeBounds.getMinDay()), defaultCompletion);</span>
<span class="pc bpc" id="L281" title="1 of 2 branches missed.">			if (currentGroup != null)</span>
<span class="nc" id="L282">				currentGroup.addTask(result);</span>

<span class="fc" id="L284">			this.modelData.putTask(code, result);</span>

<span class="pc bpc" id="L286" title="1 of 2 branches missed.">			if (previous != null)</span>
<span class="nc" id="L287">				forceTaskOrder(previous, result);</span>

		}
<span class="fc" id="L290">		return result;</span>
	}

	public PiecewiseConstant getLoadPlanableForTask(String taskId) {
<span class="fc" id="L294">		return this.dayCalendar.getOpenClose().mutateMe(this.dayCalendar.getOpenCloseForTask(taskId))</span>
<span class="fc" id="L295">				.asPiecewiseConstant();</span>
	}

	private Task getLastCreatedTask() {
<span class="nc" id="L299">		final List&lt;Task&gt; all = new ArrayList&lt;&gt;(this.modelData.getTasks());</span>
<span class="nc bnc" id="L300" title="All 2 branches missed.">		for (int i = all.size() - 1; i &gt;= 0; i--)</span>
<span class="nc bnc" id="L301" title="All 2 branches missed.">			if (all.get(i) instanceof TaskImpl)</span>
<span class="nc" id="L302">				return all.get(i);</span>

<span class="nc" id="L304">		return null;</span>
	}

	public void addSeparator(String comment) {
<span class="nc" id="L308">		TaskSeparator separator = new TaskSeparator(getSkinParam().getCurrentStyleBuilder(), comment,</span>
<span class="nc" id="L309">				this.modelData.getTasks().size());</span>
<span class="nc" id="L310">		this.modelData.putTask(separator.getCode(), separator);</span>
<span class="nc" id="L311">	}</span>

	public CommandExecutionResult addGroup(TaskCode code) {
<span class="nc" id="L314">		TaskGroup group = new TaskGroup(this.currentGroup, getSkinParam().getCurrentStyleBuilder(), code);</span>

<span class="nc bnc" id="L316" title="All 2 branches missed.">		if (this.currentGroup != null)</span>
<span class="nc" id="L317">			this.currentGroup.addTask(group);</span>

<span class="nc" id="L319">		this.currentGroup = group;</span>
<span class="nc" id="L320">		this.modelData.putTask(group.getCode(), group);</span>
<span class="nc" id="L321">		return CommandExecutionResult.ok();</span>
	}

	public CommandExecutionResult endGroup() {
<span class="nc bnc" id="L325" title="All 2 branches missed.">		if (this.currentGroup == null)</span>
<span class="nc" id="L326">			return CommandExecutionResult.error(&quot;No group to be closed&quot;);</span>

<span class="nc" id="L328">		this.currentGroup = this.currentGroup.getParent();</span>

<span class="nc" id="L330">		return CommandExecutionResult.ok();</span>
	}

	public void addContraint(GanttConstraint constraint) {
<span class="fc" id="L334">		this.modelData.addConstraint(constraint);</span>
<span class="fc" id="L335">	}</span>

	public CommandExecutionResult updateStartingPoint(LocalDate start) {
<span class="pc bpc" id="L338" title="1 of 2 branches missed.">		if (this.modelData.getTasks().size() &gt; 0)</span>
<span class="nc" id="L339">			return CommandExecutionResult.error(&quot;Starting point must be set before task definition&quot;);</span>

<span class="fc" id="L341">		this.timeBounds.setMinDay(start);</span>
<span class="fc" id="L342">		return CommandExecutionResult.ok();</span>
	}

	public LocalDate getMinDay() {
<span class="nc" id="L346">		return this.timeBounds.getMinDay();</span>
	}

	public LocalDate getMaxDay() {
<span class="nc" id="L350">		initMinMax();</span>
<span class="nc" id="L351">		return this.timeBounds.getMaxDay();</span>
	}

	public TimePoint getMinTimePoint() {
<span class="nc" id="L355">		return TimePoint.ofStartOfDay(this.timeBounds.getMinDay());</span>
	}

	public TimePoint getMaxTimePoint() {
<span class="nc" id="L359">		initMinMax();</span>
<span class="nc" id="L360">		return TimePoint.ofStartOfDay(this.timeBounds.getMaxDay());</span>
	}

	public int daysInWeek() {
<span class="nc" id="L364">		return this.dayCalendar.getOpenClose().daysInWeek();</span>
	}

	public int daysInMonth() {
<span class="nc" id="L368">		return 30;</span>
	}

	public boolean isOpen(LocalDate day) {
<span class="nc" id="L372">		return this.dayCalendar.isOpen(day);</span>
	}

	public boolean affectResource(Task result, String description) {
<span class="nc" id="L376">		final Matcher m = RESOURCE_ASSIGNMENT_PATTERN.matcher(description);</span>
<span class="nc bnc" id="L377" title="All 2 branches missed.">		if (m.find() == false)</span>
<span class="nc" id="L378">			throw new IllegalArgumentException();</span>

<span class="nc" id="L380">		final Resource resource = getResource(m.group(1));</span>
<span class="nc" id="L381">		int percentage = 100;</span>
<span class="nc bnc" id="L382" title="All 2 branches missed.">		if (m.group(3) != null)</span>
<span class="nc" id="L383">			percentage = Integer.parseInt(m.group(3));</span>

<span class="nc bnc" id="L385" title="All 2 branches missed.">		if (percentage == 0)</span>
<span class="nc" id="L386">			return false;</span>

<span class="nc" id="L388">		result.addResource(resource, percentage);</span>
<span class="nc" id="L389">		return true;</span>
	}

	public Resource getResource(String resourceName) {
<span class="nc" id="L393">		Resource resource = this.modelData.getResource(resourceName);</span>
<span class="nc bnc" id="L394" title="All 2 branches missed.">		if (resource == null)</span>
<span class="nc" id="L395">			resource = new Resource(resourceName);</span>

<span class="nc" id="L397">		this.modelData.putResource(resourceName, resource);</span>
<span class="nc" id="L398">		return resource;</span>
	}

	public Moment getExistingMoment(String id) {
<span class="nc" id="L402">		Moment result = getExistingTask(id);</span>
<span class="nc bnc" id="L403" title="All 2 branches missed.">		if (result == null) {</span>
<span class="nc" id="L404">			TimePoint start = null;</span>
<span class="nc" id="L405">			TimePoint end = null;</span>
<span class="nc bnc" id="L406" title="All 2 branches missed.">			for (Map.Entry&lt;TimePoint, String&gt; ent : this.dayCalendar.getNameDays().entrySet()) {</span>
<span class="nc bnc" id="L407" title="All 2 branches missed.">				if (ent.getValue().equalsIgnoreCase(id) == false)</span>
<span class="nc" id="L408">					continue;</span>

<span class="nc" id="L410">				start = min(start, ent.getKey());</span>
<span class="nc" id="L411">				end = max(end, ent.getKey());</span>
<span class="nc" id="L412">			}</span>
<span class="nc bnc" id="L413" title="All 2 branches missed.">			if (start != null)</span>
<span class="nc" id="L414">				result = new MomentImpl(start, end.increment());</span>

		}
<span class="nc" id="L417">		return result;</span>
	}

	private TimePoint min(TimePoint d1, TimePoint d2) {
<span class="nc bnc" id="L421" title="All 2 branches missed.">		if (d1 == null)</span>
<span class="nc" id="L422">			return d2;</span>

<span class="nc bnc" id="L424" title="All 2 branches missed.">		if (d1.compareTo(d2) &gt; 0)</span>
<span class="nc" id="L425">			return d2;</span>

<span class="nc" id="L427">		return d1;</span>
	}

	private TimePoint max(TimePoint d1, TimePoint d2) {
<span class="nc bnc" id="L431" title="All 2 branches missed.">		if (d1 == null)</span>
<span class="nc" id="L432">			return d2;</span>

<span class="nc bnc" id="L434" title="All 2 branches missed.">		if (d1.compareTo(d2) &lt; 0)</span>
<span class="nc" id="L435">			return d2;</span>

<span class="nc" id="L437">		return d1;</span>
	}

	public void colorDay(LocalDate day, HColor color) {
<span class="fc" id="L441">		this.dayCalendar.putColorDay(TimePoint.ofStartOfDay(day), color);</span>
<span class="fc" id="L442">	}</span>

	public void colorDay(DayOfWeek day, HColor color) {
<span class="nc" id="L445">		this.dayCalendar.putColorDayOfWeek(day, color);</span>
<span class="nc" id="L446">	}</span>

	public void nameDay(LocalDate day, String name) {
<span class="nc" id="L449">		this.dayCalendar.putNameDay(TimePoint.ofStartOfDay(day), name);</span>
<span class="nc" id="L450">	}</span>

	public LocalDate getToday() {
<span class="nc bnc" id="L453" title="All 2 branches missed.">		if (today == null)</span>
<span class="nc" id="L454">			this.today = TimePoint.todayUtcAtMidnight();</span>

<span class="nc" id="L456">		return today.toDay();</span>
	}

	public void setTodayColors(CenterBorderColor colors) {
<span class="nc bnc" id="L460" title="All 2 branches missed.">		if (today == null)</span>
<span class="nc" id="L461">			this.today = TimePoint.todayUtcAtMidnight();</span>

<span class="nc" id="L463">		this.dayCalendar.putColorDayToday(today, colors.getCenter());</span>
<span class="nc" id="L464">	}</span>

	public CommandExecutionResult setToday(LocalDate date) {
<span class="nc" id="L467">		this.today = TimePoint.ofStartOfDay(date);</span>
<span class="nc" id="L468">		return CommandExecutionResult.ok();</span>
	}

	public CommandExecutionResult deleteTask(Task task) {
<span class="nc" id="L472">		task.setColors(new CenterBorderColor(HColors.WHITE, HColors.BLACK));</span>
<span class="nc" id="L473">		return CommandExecutionResult.ok();</span>
	}

	public void setPrintInterval(LocalDate start, LocalDate end) {
<span class="nc" id="L477">		this.timeBounds.setPrintStart(start);</span>
<span class="nc" id="L478">		this.timeBounds.setPrintEnd(end);</span>
<span class="nc" id="L479">	}</span>

	public CommandExecutionResult addNote(Display note, Stereotype stereotype) {
<span class="nc" id="L482">		Task last = null;</span>
<span class="nc bnc" id="L483" title="All 2 branches missed.">		for (Task current : this.modelData.getTasks())</span>
<span class="nc" id="L484">			last = current;</span>
<span class="nc bnc" id="L485" title="All 2 branches missed.">		if (last == null)</span>
<span class="nc" id="L486">			return CommandExecutionResult.error(&quot;No task defined&quot;);</span>

<span class="nc" id="L488">		last.setNote(note, stereotype);</span>
<span class="nc" id="L489">		return CommandExecutionResult.ok();</span>
	}

	public void setShowFootbox(boolean footbox) {
<span class="nc" id="L493">		this.displayConfig.setShowFootbox(footbox);</span>
<span class="nc" id="L494">	}</span>

	@Override
	public ClockwiseTopRightBottomLeft getDefaultMargins() {
<span class="fc" id="L498">		return ClockwiseTopRightBottomLeft.none();</span>
	}

	public void setLabelStrategy(LabelStrategy strategy) {
<span class="nc" id="L502">		this.displayConfig.setLabelStrategy(strategy);</span>
<span class="nc" id="L503">	}</span>

	public void setWeeklyHeaderStrategy(WeeklyHeaderStrategy weeklyHeaderStrategy, int weekStartingNumber) {
<span class="nc" id="L506">		this.weekConfig.setWeeklyHeaderStrategy(weeklyHeaderStrategy);</span>
<span class="nc" id="L507">		this.weekConfig.setWeekStartingNumber(weekStartingNumber);</span>
<span class="nc" id="L508">	}</span>

	public CommandExecutionResult hideResourceName() {
<span class="nc" id="L511">		this.displayConfig.setHideResourceName(true);</span>
<span class="nc" id="L512">		return CommandExecutionResult.ok();</span>
	}

	public CommandExecutionResult hideResourceFootbox() {
<span class="nc" id="L516">		this.displayConfig.setHideResourceFootbox(true);</span>
<span class="nc" id="L517">		return CommandExecutionResult.ok();</span>
	}

	public void addVerticalSeparatorBefore(LocalDate day) {
<span class="nc" id="L521">		this.dayCalendar.addSeparatorBefore(day);</span>
<span class="nc" id="L522">	}</span>

	public void setTaskDefaultCompletion(int defaultCompletion) {
<span class="nc" id="L525">		this.defaultCompletion = defaultCompletion;</span>
<span class="nc" id="L526">	}</span>

	public List&lt;TaskDrawRegular&gt; getAllTasksForResource(Resource res) {
<span class="nc" id="L529">		final List&lt;TaskDrawRegular&gt; result = new ArrayList&lt;TaskDrawRegular&gt;();</span>
<span class="nc bnc" id="L530" title="All 2 branches missed.">		for (Task task : this.modelData.getTasks())</span>
<span class="nc bnc" id="L531" title="All 2 branches missed.">			if (task.isAssignedTo(res)) {</span>
<span class="nc" id="L532">				final TaskDrawRegular draw = (TaskDrawRegular) this.drawRegistry.getTaskDraw(task);</span>
<span class="nc" id="L533">				result.add(draw);</span>
			}

<span class="nc" id="L536">		return Collections.unmodifiableList(result);</span>
	}

	public void setIt(Task result) {
<span class="fc" id="L540">		this.it = result;</span>
<span class="fc" id="L541">	}</span>

	public Task getIt() {
<span class="nc" id="L544">		return it;</span>
	}

	public final Resource getThey() {
<span class="nc" id="L548">		return they;</span>
	}

	public final void setThey(Resource they) {
<span class="nc" id="L552">		this.they = they;</span>
<span class="nc" id="L553">	}</span>

	public void setHideClosed(boolean hideClosed) {
<span class="nc" id="L556">		this.scaleConfig.setHideClosed(hideClosed);</span>
<span class="nc" id="L557">	}</span>

	public PiecewiseConstant getDefaultPlan() {
<span class="nc" id="L560">		return this.dayCalendar.getDefaultPlan();</span>
	}

	public HColorSet getIHtmlColorSet() {
<span class="fc" id="L564">		return this.timelineStyle.getColorSet();</span>
	}

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.14.202510111229</span></div></body></html>