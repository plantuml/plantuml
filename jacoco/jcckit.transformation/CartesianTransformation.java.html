<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>CartesianTransformation.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">plantuml</a> &gt; <a href="index.source.html" class="el_package">jcckit.transformation</a> &gt; <span class="el_source">CartesianTransformation.java</span></div><h1>CartesianTransformation.java</h1><pre class="source lang-java linenums">/*
 * Copyright 2003-2004, Franz-Josef Elmer, All rights reserved
 *
 * This library is free software; you can redistribute it and/or modify
 * it under the terms of the GNU Lesser General Public License as published by
 * the Free Software Foundation; either version 2.1 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Lesser General Public License for more details
 * (http://www.gnu.org/copyleft/lesser.html).
 *
 * You should have received a copy of the GNU Lesser General Public License
 * along with this library; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 */
package jcckit.transformation;

import jcckit.data.DataPoint;
import jcckit.graphic.GraphPoint;
import jcckit.util.Util;

/**
 *  Two-dimensional Cartesian transformation. The two independent
 *  transformations for the x-axis and the y-axis can be logarithmic
 *  from data coordinates to device-independent coordinates in order to
 *  realize diagrams with logarithmic scales.
 *
 *  @author Franz-Josef Elmer
 */
public class CartesianTransformation implements Transformation {
    // ::remove folder when __HAXE__
  private final boolean _xLogScale;
  private final double _xOffset;
  private final double _xScale;
  private final boolean _yLogScale;
  private final double _yOffset;
  private final double _yScale;

  /**
   *  Creates an instance from the specified reference points.
   *  Note, that the reference points must differ in x and y coordinates
   *  otherwise a transformation would not be possible.
   *  @param xLogScale &lt;tt&gt;true&lt;/tt&gt; if logarithmic x axis.
   *  @param yLogScale &lt;tt&gt;true&lt;/tt&gt; if logarithmic y axis.
   *  @param dataPoint1 First reference point in data coordinates.
   *  @param graphPoint1 First reference point in device-independent 
   *         coordinates.
   *  @param dataPoint2 Second reference point in data coordinates.
   *  @param graphPoint2 Second reference point in device-independent
   *         coordinates.
   *  @throws IllegalArgumentException if transformation in at least
   *          one of both directions is not possible.
   */
  public CartesianTransformation(boolean xLogScale, boolean yLogScale,
                           DataPoint dataPoint1, GraphPoint graphPoint1,
<span class="nc" id="L59">                           DataPoint dataPoint2, GraphPoint graphPoint2) {</span>
<span class="nc" id="L60">    _xLogScale = xLogScale;</span>
<span class="nc" id="L61">    double d1 = Util.log(dataPoint1.getX(), xLogScale);</span>
<span class="nc" id="L62">    double dd = Util.log(dataPoint2.getX(), xLogScale) - d1;</span>
<span class="nc" id="L63">    check(dd, &quot;data&quot;, &quot;x&quot;, d1);</span>
<span class="nc" id="L64">    _xScale = (graphPoint2.getX() - graphPoint1.getX()) / dd;</span>
<span class="nc" id="L65">    check(_xScale, &quot;graphical&quot;, &quot;x&quot;, graphPoint1.getX());</span>
<span class="nc" id="L66">    _xOffset = graphPoint1.getX() - d1 * _xScale;</span>

<span class="nc" id="L68">    _yLogScale = yLogScale;</span>
<span class="nc" id="L69">    d1 = Util.log(dataPoint1.getY(), yLogScale);</span>
<span class="nc" id="L70">    dd = Util.log(dataPoint2.getY(), yLogScale) - d1;</span>
<span class="nc" id="L71">    check(dd, &quot;data&quot;, &quot;y&quot;, d1);</span>
<span class="nc" id="L72">    _yScale = (graphPoint2.getY() - graphPoint1.getY()) / dd;</span>
<span class="nc" id="L73">    check(_yScale, &quot;graphical&quot;, &quot;y&quot;, graphPoint1.getY());</span>
<span class="nc" id="L74">    _yOffset = graphPoint1.getY() - d1 * _yScale;</span>
<span class="nc" id="L75">  }</span>

  private void check(double valueToCheck, String type, String axis,
                     double value) {
<span class="nc bnc" id="L79" title="All 2 branches missed.">    if (valueToCheck == 0) {</span>
<span class="nc" id="L80">      throw new IllegalArgumentException(&quot;The &quot; + type</span>
          + &quot; reference points in &quot; + axis + &quot; must be different; both are &quot;
          + value);
    }
<span class="nc" id="L84">  }</span>

  public GraphPoint transformToGraph(DataPoint point) {
<span class="nc" id="L87">    return new GraphPoint(</span>
<span class="nc" id="L88">        _xOffset + Util.log(point.getX(), _xLogScale) * _xScale,</span>
<span class="nc" id="L89">        _yOffset + Util.log(point.getY(), _yLogScale) * _yScale);</span>
  }

  public DataPoint transformToData(GraphPoint point) {
<span class="nc" id="L93">    return new DataPoint(</span>
<span class="nc" id="L94">        Util.exp((point.getX() - _xOffset) / _xScale, _xLogScale),</span>
<span class="nc" id="L95">        Util.exp((point.getY() - _yOffset) / _yScale, _yLogScale));</span>
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span></div></body></html>