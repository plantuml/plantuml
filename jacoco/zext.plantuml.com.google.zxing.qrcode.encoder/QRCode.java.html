<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>QRCode.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">plantuml</a> &gt; <a href="index.source.html" class="el_package">zext.plantuml.com.google.zxing.qrcode.encoder</a> &gt; <span class="el_source">QRCode.java</span></div><h1>QRCode.java</h1><pre class="source lang-java linenums">/*
 * Copyright 2008 ZXing authors
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package zext.plantuml.com.google.zxing.qrcode.encoder;

import zext.plantuml.com.google.zxing.qrcode.decoder.ErrorCorrectionLevel;
import zext.plantuml.com.google.zxing.qrcode.decoder.Mode;

/**
 * @author satorux@google.com (Satoru Takabayashi) - creator
 * @author dswitkin@google.com (Daniel Switkin) - ported from C++
 */
public final class QRCode {

  public static final int NUM_MASK_PATTERNS = 8;

  private Mode mode;
  private ErrorCorrectionLevel ecLevel;
  private int version;
  private int matrixWidth;
  private int maskPattern;
  private int numTotalBytes;
  private int numDataBytes;
  private int numECBytes;
  private int numRSBlocks;
  private ByteMatrix matrix;

<span class="nc" id="L41">  public QRCode() {</span>
<span class="nc" id="L42">    mode = null;</span>
<span class="nc" id="L43">    ecLevel = null;</span>
<span class="nc" id="L44">    version = -1;</span>
<span class="nc" id="L45">    matrixWidth = -1;</span>
<span class="nc" id="L46">    maskPattern = -1;</span>
<span class="nc" id="L47">    numTotalBytes = -1;</span>
<span class="nc" id="L48">    numDataBytes = -1;</span>
<span class="nc" id="L49">    numECBytes = -1;</span>
<span class="nc" id="L50">    numRSBlocks = -1;</span>
<span class="nc" id="L51">    matrix = null;</span>
<span class="nc" id="L52">  }</span>

  // Mode of the QR Code.
  public Mode getMode() {
<span class="nc" id="L56">    return mode;</span>
  }

  // Error correction level of the QR Code.
  public ErrorCorrectionLevel getECLevel() {
<span class="nc" id="L61">    return ecLevel;</span>
  }

  // Version of the QR Code.  The bigger size, the bigger version.
  public int getVersion() {
<span class="nc" id="L66">    return version;</span>
  }

  // ByteMatrix width of the QR Code.
  public int getMatrixWidth() {
<span class="nc" id="L71">    return matrixWidth;</span>
  }

  // Mask pattern of the QR Code.
  public int getMaskPattern() {
<span class="nc" id="L76">    return maskPattern;</span>
  }

  // Number of total bytes in the QR Code.
  public int getNumTotalBytes() {
<span class="nc" id="L81">    return numTotalBytes;</span>
  }

  // Number of data bytes in the QR Code.
  public int getNumDataBytes() {
<span class="nc" id="L86">    return numDataBytes;</span>
  }

  // Number of error correction bytes in the QR Code.
  public int getNumECBytes() {
<span class="nc" id="L91">    return numECBytes;</span>
  }

  // Number of Reedsolomon blocks in the QR Code.
  public int getNumRSBlocks() {
<span class="nc" id="L96">    return numRSBlocks;</span>
  }

  // ByteMatrix data of the QR Code.
  public ByteMatrix getMatrix() {
<span class="nc" id="L101">    return matrix;</span>
  }
  

  // Return the value of the module (cell) pointed by &quot;x&quot; and &quot;y&quot; in the matrix of the QR Code. They
  // call cells in the matrix &quot;modules&quot;. 1 represents a black cell, and 0 represents a white cell.
  public int at(int x, int y) {
    // The value must be zero or one.
<span class="nc" id="L109">    int value = matrix.get(x, y);</span>
<span class="nc bnc" id="L110" title="All 4 branches missed.">    if (!(value == 0 || value == 1)) {</span>
      // this is really like an assert... not sure what better exception to use?
<span class="nc" id="L112">      throw new RuntimeException(&quot;Bad value&quot;);</span>
    }
<span class="nc" id="L114">    return value;</span>
  }

  // Checks all the member variables are set properly. Returns true on success. Otherwise, returns
  // false.
  public boolean isValid() {
<span class="nc bnc" id="L120" title="All 18 branches missed.">    return</span>
        // First check if all version are not uninitialized.
        mode != null &amp;&amp;
        ecLevel != null &amp;&amp;
        version != -1 &amp;&amp;
        matrixWidth != -1 &amp;&amp;
        maskPattern != -1 &amp;&amp;
        numTotalBytes != -1 &amp;&amp;
        numDataBytes != -1 &amp;&amp;
        numECBytes != -1 &amp;&amp;
        numRSBlocks != -1 &amp;&amp;
        // Then check them in other ways..
<span class="nc bnc" id="L132" title="All 6 branches missed.">        isValidMaskPattern(maskPattern) &amp;&amp;</span>
        numTotalBytes == numDataBytes + numECBytes &amp;&amp;
        // ByteMatrix stuff.
        matrix != null &amp;&amp;
<span class="nc bnc" id="L136" title="All 2 branches missed.">        matrixWidth == matrix.getWidth() &amp;&amp;</span>
        // See 7.3.1 of JISX0510:2004 (p.5).
<span class="nc bnc" id="L138" title="All 2 branches missed.">        matrix.getWidth() == matrix.getHeight(); // Must be square.</span>
  }

  // Return debug String.
  public String toString() {
<span class="nc" id="L143">    StringBuilder result = new StringBuilder(200);</span>
<span class="nc" id="L144">    result.append(&quot;&lt;&lt;\n&quot;);</span>
<span class="nc" id="L145">    result.append(&quot; mode: &quot;);</span>
<span class="nc" id="L146">    result.append(mode);</span>
<span class="nc" id="L147">    result.append(&quot;\n ecLevel: &quot;);</span>
<span class="nc" id="L148">    result.append(ecLevel);</span>
<span class="nc" id="L149">    result.append(&quot;\n version: &quot;);</span>
<span class="nc" id="L150">    result.append(version);</span>
<span class="nc" id="L151">    result.append(&quot;\n matrixWidth: &quot;);</span>
<span class="nc" id="L152">    result.append(matrixWidth);</span>
<span class="nc" id="L153">    result.append(&quot;\n maskPattern: &quot;);</span>
<span class="nc" id="L154">    result.append(maskPattern);</span>
<span class="nc" id="L155">    result.append(&quot;\n numTotalBytes: &quot;);</span>
<span class="nc" id="L156">    result.append(numTotalBytes);</span>
<span class="nc" id="L157">    result.append(&quot;\n numDataBytes: &quot;);</span>
<span class="nc" id="L158">    result.append(numDataBytes);</span>
<span class="nc" id="L159">    result.append(&quot;\n numECBytes: &quot;);</span>
<span class="nc" id="L160">    result.append(numECBytes);</span>
<span class="nc" id="L161">    result.append(&quot;\n numRSBlocks: &quot;);</span>
<span class="nc" id="L162">    result.append(numRSBlocks);</span>
<span class="nc bnc" id="L163" title="All 2 branches missed.">    if (matrix == null) {</span>
<span class="nc" id="L164">      result.append(&quot;\n matrix: null\n&quot;);</span>
    } else {
<span class="nc" id="L166">      result.append(&quot;\n matrix:\n&quot;);</span>
<span class="nc" id="L167">      result.append(matrix.toString());</span>
    }
<span class="nc" id="L169">    result.append(&quot;&gt;&gt;\n&quot;);</span>
<span class="nc" id="L170">    return result.toString();</span>
  }

  public void setMode(Mode value) {
<span class="nc" id="L174">    mode = value;</span>
<span class="nc" id="L175">  }</span>

  public void setECLevel(ErrorCorrectionLevel value) {
<span class="nc" id="L178">    ecLevel = value;</span>
<span class="nc" id="L179">  }</span>

  public void setVersion(int value) {
<span class="nc" id="L182">    version = value;</span>
<span class="nc" id="L183">  }</span>

  public void setMatrixWidth(int value) {
<span class="nc" id="L186">    matrixWidth = value;</span>
<span class="nc" id="L187">  }</span>

  public void setMaskPattern(int value) {
<span class="nc" id="L190">    maskPattern = value;</span>
<span class="nc" id="L191">  }</span>

  public void setNumTotalBytes(int value) {
<span class="nc" id="L194">    numTotalBytes = value;</span>
<span class="nc" id="L195">  }</span>

  public void setNumDataBytes(int value) {
<span class="nc" id="L198">    numDataBytes = value;</span>
<span class="nc" id="L199">  }</span>

  public void setNumECBytes(int value) {
<span class="nc" id="L202">    numECBytes = value;</span>
<span class="nc" id="L203">  }</span>

  public void setNumRSBlocks(int value) {
<span class="nc" id="L206">    numRSBlocks = value;</span>
<span class="nc" id="L207">  }</span>

  // This takes ownership of the 2D array.
  public void setMatrix(ByteMatrix value) {
<span class="nc" id="L211">    matrix = value;</span>
<span class="nc" id="L212">  }</span>

  // Check if &quot;mask_pattern&quot; is valid.
  public static boolean isValidMaskPattern(int maskPattern) {
<span class="nc bnc" id="L216" title="All 4 branches missed.">    return maskPattern &gt;= 0 &amp;&amp; maskPattern &lt; NUM_MASK_PATTERNS;</span>
  }

  // Return true if the all values in the matrix are binary numbers.
  //
  // JAVAPORT: This is going to be super expensive and unnecessary, we should not call this in
  // production. I'm leaving it because it may be useful for testing. It should be removed entirely
  // if ByteMatrix is changed never to contain a -1.
  /*
  private static boolean EverythingIsBinary(final ByteMatrix matrix) {
    for (int y = 0; y &lt; matrix.height(); ++y) {
      for (int x = 0; x &lt; matrix.width(); ++x) {
        int value = matrix.get(y, x);
        if (!(value == 0 || value == 1)) {
          // Found non zero/one value.
          return false;
        }
      }
    }
    return true;
  }
   */

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.13.202504020838</span></div></body></html>